<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="Electron" modified="2024-01-20T08:30:00.000Z" agent="5.0" version="21.1.2" etag="abc123" type="device">
  <diagram id="nginx-underscores-fix" name="Nginxä¸‹åˆ’çº¿è¯·æ±‚å¤´ä¿®å¤è¿‡ç¨‹">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- æ ‡é¢˜ -->
        <mxCell id="title" value="Nginx å¸¦ä¸‹åˆ’çº¿è¯·æ±‚å¤´(system_id)ä¿®å¤è¿‡ç¨‹" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="300" y="20" width="400" height="30" as="geometry" />
        </mxCell>
        
        <!-- é—®é¢˜å‘çŽ° -->
        <mxCell id="problem" value="ðŸš¨ é—®é¢˜å‘çŽ°&lt;br/&gt;&lt;br/&gt;â€¢ ç›´æŽ¥è®¿é—® localhost:4000 âœ… æ­£å¸¸&lt;br/&gt;â€¢ nginxä»£ç†è®¿é—® âŒ NPEé”™è¯¯&lt;br/&gt;â€¢ system_idè¯·æ±‚å¤´ä¸¢å¤±" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#ff0000;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="50" y="80" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- æ ¹å› åˆ†æž -->
        <mxCell id="analysis" value="ðŸ” æ ¹å› åˆ†æž&lt;br/&gt;&lt;br/&gt;â€¢ nginxé»˜è®¤å¿½ç•¥å¸¦ä¸‹åˆ’çº¿çš„è¯·æ±‚å¤´&lt;br/&gt;â€¢ ç¼ºå°‘ underscores_in_headers on&lt;br/&gt;â€¢ è‡ªå®šä¹‰è¯·æ±‚å¤´æœªè½¬å‘" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="300" y="80" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- ä¿®å¤æ–¹æ¡ˆ -->
        <mxCell id="solution" value="ðŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ&lt;br/&gt;&lt;br/&gt;1. æ·»åŠ  underscores_in_headers on&lt;br/&gt;2. è½¬å‘æ‰€æœ‰è‡ªå®šä¹‰è¯·æ±‚å¤´&lt;br/&gt;3. æ·»åŠ è°ƒè¯•æ—¥å¿—" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="550" y="80" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- ä¿®å¤å‰é…ç½® -->
        <mxCell id="before-config" value="ä¿®å¤å‰é…ç½®&lt;br/&gt;&lt;br/&gt;âŒ æ—  underscores_in_headers&lt;br/&gt;âŒ åªè½¬å‘åŸºç¡€è¯·æ±‚å¤´&lt;br/&gt;âŒ æ— è°ƒè¯•æ—¥å¿—" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="100" y="220" width="180" height="80" as="geometry" />
        </mxCell>
        
        <!-- ä¿®å¤åŽé…ç½® -->
        <mxCell id="after-config" value="ä¿®å¤åŽé…ç½®&lt;br/&gt;&lt;br/&gt;âœ… underscores_in_headers on&lt;br/&gt;âœ… è½¬å‘ authorizationã€system_id ç­‰&lt;br/&gt;âœ… æ·»åŠ è°ƒè¯•æ—¥å¿—æ ¼å¼" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="320" y="220" width="180" height="80" as="geometry" />
        </mxCell>
        
        <!-- éªŒè¯ç»“æžœ -->
        <mxCell id="result" value="ðŸŽ‰ éªŒè¯ç»“æžœ&lt;br/&gt;&lt;br/&gt;âœ… APIè¿”å›žæ­£å¸¸æ•°æ®&lt;br/&gt;âœ… æ—¥å¿—æ˜¾ç¤ºè¯·æ±‚å¤´è½¬å‘æˆåŠŸ&lt;br/&gt;âœ… NPEé—®é¢˜å®Œå…¨è§£å†³" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="540" y="220" width="180" height="80" as="geometry" />
        </mxCell>
        
        <!-- æ ¸å¿ƒé…ç½®ä»£ç  -->
        <mxCell id="config-code" value="å…³é”®é…ç½®ä»£ç &lt;br/&gt;&lt;br/&gt;http {&lt;br/&gt;    underscores_in_headers on;&lt;br/&gt;    ...&lt;br/&gt;    proxy_set_header system_id $http_system_id;&lt;br/&gt;    proxy_set_header authorization $http_authorization;&lt;br/&gt;    proxy_pass_request_headers on;&lt;br/&gt;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="50" y="340" width="300" height="120" as="geometry" />
        </mxCell>
        
        <!-- æµ‹è¯•å‘½ä»¤ -->
        <mxCell id="test-cmd" value="æµ‹è¯•å‘½ä»¤&lt;br/&gt;&lt;br/&gt;curl -s --insecure \&lt;br/&gt;  &quot;https://10.75.29.104/api/home/api/faqTenantLanguage&quot; \&lt;br/&gt;  -H &quot;authorization: TOKEN&quot; \&lt;br/&gt;  -H &quot;system_id: 5&quot;&lt;br/&gt;&lt;br/&gt;è¿”å›ž: {&quot;code&quot;:0,&quot;data&quot;:[...]}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="400" y="340" width="320" height="120" as="geometry" />
        </mxCell>
        
        <!-- é‡è¦æç¤º -->
        <mxCell id="important" value="ðŸ’¡ é‡è¦æç¤º&lt;br/&gt;&lt;br/&gt;â€¢ nginxé»˜è®¤ä¼šå¿½ç•¥å¸¦ä¸‹åˆ’çº¿çš„HTTPè¯·æ±‚å¤´&lt;br/&gt;â€¢ å¿…é¡»æ˜¾å¼å¼€å¯ underscores_in_headers on&lt;br/&gt;â€¢ è¿™æ˜¯nginxçš„å®‰å…¨ç‰¹æ€§ï¼Œéœ€è¦è°¨æ…Žå¯ç”¨&lt;br/&gt;â€¢ å»ºè®®åªåœ¨å¿…è¦æ—¶ä½¿ç”¨å¸¦ä¸‹åˆ’çº¿çš„è¯·æ±‚å¤´" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="200" y="500" width="400" height="100" as="geometry" />
        </mxCell>
        
        <!-- ç®­å¤´è¿žæŽ¥ -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="problem" target="analysis">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="analysis" target="solution">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="before-config" target="after-config">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="after-config" target="result">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="solution" target="result">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile> 